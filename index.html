<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oasis Health Care - Patient Registration</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Fixed header styling */
        #mainHeader {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #f8f4fc 0%, #e8dff5 100%);
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(106, 13, 173, 0.2);
            padding: 15px 20px;
            border-bottom: 3px solid #c8a2c8;
        }
        
        #mainHeader h1 {
            margin: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        #welcomeMessage {
            font-size: 16px;
            color: #6a0dad;
            text-align: center;
            margin-top: 10px;
            font-weight: bold;
        }
        
        #newUserCheckbox {
            text-align: center;
            margin-top: 8px;
            font-size: 14px;
        }
        
        #newUserCheckbox input {
            margin-right: 5px;
        }
        
        /* Add padding to body to account for fixed header */
        body {
            padding-top: 180px;
            padding-bottom: 100px;
        }
        
        /* Fixed footer styling */
        footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(135deg, #e8dff5 0%, #f8f4fc 100%);
            z-index: 1000;
            box-shadow: 0 -2px 10px rgba(106, 13, 173, 0.2);
            padding: 15px 20px;
            border-top: 3px solid #c8a2c8;
        }
        
        /* Timer styling */
        #sessionTimer {
            position: fixed;
            top: 160px;
            right: 20px;
            background: white;
            padding: 15px 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(106, 13, 173, 0.3);
            border: 2px solid #c8a2c8;
            z-index: 999;
            font-weight: bold;
            color: #6a0dad;
            min-width: 150px;
            text-align: center;
        }
        
        #sessionTimer.warning {
            background: #fff3cd;
            border-color: #ffc107;
            color: #856404;
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        #timerDisplay {
            font-size: 24px;
            margin: 5px 0;
        }
        
        /* iframe container */
        .iframe-container {
            margin: 30px auto;
            max-width: 800px;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(106, 13, 173, 0.2);
        }
        
        .iframe-container iframe {
            width: 100%;
            border: 2px solid #c8a2c8;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <header id="mainHeader">
        <h1>
            <img src="the-symbol-of-family-healthcare-by-stethoscope.jpg" alt="Clinic Logo" width="60" height="60" style="vertical-align: middle; border-radius: 50%; box-shadow: 0 2px 5px rgba(106, 13, 173, 0.3);"> 
            Oasis Health Care - Patient Registration
        </h1>
        <div id="welcomeMessage"></div>
        <div id="newUserCheckbox" style="display: none;">
            <label>
                <input type="checkbox" id="notMeCheckbox" onchange="startAsNewUser()">
                <span id="notMeLabel"></span>
            </label>
        </div>
    </header>

    <!-- Session Timer -->
    <div id="sessionTimer">
        <div>‚è±Ô∏è Time Remaining</div>
        <div id="timerDisplay">10:00</div>
        <div style="font-size: 12px; margin-top: 5px;">Session Timeout</div>
    </div>
    
    <!-- Current Date/Time Display -->
    <p style="text-align: right; margin-top: 20px; margin-bottom: 20px; font-weight: bold;">
        <span id="currentDateTime"></span>
    </p>

    <!-- Health Tips iFrame Section -->
    <div class="iframe-container">
        <h2 style="text-align: center; color: #6a0dad; margin-bottom: 15px;">üìã Health & Wellness Information</h2>
        <iframe src="healthcare-info.html" height="350" title="Health Tips"></iframe>
    </div>

    <form id="patient-form" method="post" onsubmit="return false;">
        
        <!-- Block 1: Personal Information -->
        <h2>Personal Information</h2>
        
        <table cellpadding="5" cellspacing="0">
            <tr>
                <td class="required">First Name:</td>
                <td colspan="3">
                    <input type="text" 
                           id="firstName" 
                           name="firstName" 
                           title="Enter your first name (1-30 characters, letters, apostrophes, and dashes only)"
                           pattern="[A-Za-z'\-]{1,30}"
                           minlength="1"
                           maxlength="30"
                           onblur="saveToLocalStorage('firstName')"
                           required>
                </td>
            </tr>
            <tr>
                <td>Middle Initial:</td>
                <td colspan="3">
                    <input type="text" 
                           id="middleInitial" 
                           name="middleInitial" 
                           title="Enter your middle initial (optional, one letter only)"
                           pattern="[A-Za-z]?"
                           maxlength="1"
                           onblur="saveToLocalStorage('middleInitial')">
                </td>
            </tr>
            <tr>
                <td class="required">Last Name:</td>
                <td colspan="3">
                    <input type="text" 
                           id="lastName" 
                           name="lastName" 
                           title="Enter your last name (1-30 characters, letters, apostrophes, dashes, and numbers 2-5 like Jr. or III)"
                           pattern="[A-Za-z'2-5\-]{1,30}"
                           minlength="1"
                           maxlength="30"
                           onblur="saveToLocalStorage('lastName')"
                           required>
                </td>
            </tr>
            <tr>
                <td class="required">Date of Birth:</td>
                <td colspan="3">
                    <input type="date" 
                           id="dob" 
                           name="dob" 
                           title="Select your date of birth (must be between 120 years ago and today)"
                           onblur="saveToLocalStorage('dob')"
                           required>
                </td>
            </tr>
            <tr>
                <td class="required">Social Security:</td>
                <td colspan="3">
                    <input type="text" 
                           id="ssnDisplay" 
                           style="width: 100%; font-family: monospace; letter-spacing: 1px;"
                           placeholder="***-**-****"
                           title="Enter your Social Security Number (numbers will be hidden, dashes visible)"
                           required>
                    <input type="hidden" 
                           id="ssn" 
                           name="ssn">
                    <small style="color: #999;">‚ö†Ô∏è Secure field - not saved to local storage</small>
                </td>
            </tr>
            <tr>
                <td class="required">User ID:</td>
                <td colspan="3">
                    <input type="text" 
                           id="userId" 
                           name="userId" 
                           title="Create a username (5-30 characters, letters and numbers only, no spaces, must start with a letter)"
                           pattern="[A-Za-z][A-Za-z0-9_-]{4,29}"
                           minlength="5"
                           maxlength="30"
                           onblur="saveToLocalStorage('userId')"
                           required>
                </td>
            </tr>
            <tr>
                <td class="required">Password:</td>
                <td colspan="3">
                    <input type="password" 
                           id="password" 
                           name="password" 
                           title="Create a password (8-30 characters, must contain: 1 uppercase, 1 lowercase, 1 number, 1 special character !@#$%^&*()-_+=\/<>.,`~)"
                           pattern="^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()\-_+=\\\/<>.,`~])[A-Za-z\d!@#$%^&*()\-_+=\\\/<>.,`~]{8,30}$"
                           minlength="8"
                           maxlength="30"
                           required>
                    <small style="color: #999;">‚ö†Ô∏è Secure field - not saved to local storage</small>
                </td>
            </tr>
            <tr>
                <td class="required">Re-enter Password:</td>
                <td colspan="3">
                    <input type="password" 
                           id="confirmPassword" 
                           name="confirmPassword" 
                           title="Re-enter your password to confirm (must match the password above)"
                           minlength="8"
                           maxlength="30"
                           required>
                </td>
            </tr>
        </table>

        <!-- Block 2: Contact & Address Information -->
        <h2>Contact & Address Information</h2>
        
        <table cellpadding="5" cellspacing="0">
            <tr>
                <td class="required">Email Address:</td>
                <td colspan="3">
                    <input type="email" 
                           id="email" 
                           name="email" 
                           title="Enter your email address in format: name@domain.com"
                           pattern="[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}"
                           placeholder="name@domain.com"
                           onblur="saveToLocalStorage('email')"
                           required>
                </td>
            </tr>
            <tr>
                <td class="required">Phone Number:</td>
                <td colspan="3">
                    <input type="tel" 
                           id="phone" 
                           name="phone" 
                           title="Enter your phone number in format: 000-000-0000"
                           pattern="\d{3}-\d{3}-\d{4}"
                           placeholder="000-000-0000"
                           onblur="saveToLocalStorage('phone')"
                           required>
                </td>
            </tr>
            <tr>
                <td class="required">Address Line 1:</td>
                <td colspan="3">
                    <input type="text" 
                           id="address1" 
                           name="address1" 
                           title="Enter your street address (2-30 characters required)"
                           minlength="2"
                           maxlength="30"
                           onblur="saveToLocalStorage('address1')"
                           required>
                </td>
            </tr>
            <tr>
                <td>Address Line 2:</td>
                <td colspan="3">
                    <input type="text" 
                           id="address2" 
                           name="address2" 
                           title="Enter apartment, suite, or unit number (optional, 2-30 characters if entered)"
                           minlength="2"
                           maxlength="30"
                           pattern=".{2,30}|^$"
                           onblur="saveToLocalStorage('address2')">
                </td>
            </tr>
            <tr>
                <td class="required">City:</td>
                <td>
                    <input type="text" 
                           id="city" 
                           name="city" 
                           title="Enter your city name (2-30 characters, letters and spaces only)"
                           pattern="[A-Za-z ]{2,30}"
                           minlength="2"
                           maxlength="30"
                           onblur="saveToLocalStorage('city')"
                           required>
                </td>
                <td class="required">State:</td>
                <td>
                    <select id="state" 
                            name="state" 
                            title="Select your state from the dropdown list"
                            onchange="saveToLocalStorage('state')"
                            required>
                        <option value="">Select State</option>
                    </select>
                </td>
            </tr>
            <tr>
                <td class="required">ZIP Code:</td>
                <td colspan="3">
                    <input type="text" 
                           id="zipCode" 
                           name="zipCode" 
                           title="Enter your ZIP code (5 digits required, optional +4 extension supported)"
                           pattern="\d{5}(-\d{4})?"
                           placeholder="00000 or 00000-0000"
                           maxlength="10"
                           onblur="saveToLocalStorage('zipCode')"
                           required>
                </td>
            </tr>
        </table>

        <!-- Block 3: Medical History & Health Details -->
        <h2>Medical History & Health Details</h2>
        
        <table cellpadding="5" cellspacing="0">
            <tr>
                <td colspan="4">Describe Symptoms:</td>
            </tr>
            <tr>
                <td colspan="4">
                    <textarea id="symptoms" 
                              name="symptoms" 
                              rows="4" 
                              title="Describe your current symptoms (optional, avoid using quotation marks)"
                              pattern='[^"]*'
                              onblur="saveToLocalStorage('symptoms')"
                              placeholder="Describe current symptoms here..."></textarea>
                </td>
            </tr>
            <tr>
                <td colspan="4" class="required" style="font-weight: bold; color: #7b2cbf; padding-top: 15px;">
                    Check all conditions you have experienced:
                </td>
            </tr>
            <tr>
                <td colspan="4" id="conditionsCheckboxes">
                    <!-- Conditions will be loaded dynamically via Fetch API -->
                </td>
            </tr>
            <tr>
                <td class="required">Gender:</td>
                <td colspan="3">
                    <input type="radio" id="genderMale" name="gender" value="Male" title="Select if you are male" onchange="saveToLocalStorage('gender')" required>
                    <label for="genderMale">Male</label>
                    
                    <input type="radio" id="genderFemale" name="gender" value="Female" title="Select if you are female" onchange="saveToLocalStorage('gender')">
                    <label for="genderFemale">Female</label>
                    
                    <input type="radio" id="genderOther" name="gender" value="Other" title="Select if you identify as other" onchange="saveToLocalStorage('gender')">
                    <label for="genderOther">Other</label>
                </td>
            </tr>
            <tr>
                <td class="required">Vaccinated?</td>
                <td colspan="3">
                    <input type="radio" id="vaccinatedYes" name="vaccinated" value="Yes" title="Select if you are vaccinated" onchange="saveToLocalStorage('vaccinated')" required>
                    <label for="vaccinatedYes">Yes</label>
                    
                    <input type="radio" id="vaccinatedNo" name="vaccinated" value="No" title="Select if you are not vaccinated" onchange="saveToLocalStorage('vaccinated')">
                    <label for="vaccinatedNo">No</label>
                </td>
            </tr>
            <tr>
                <td class="required">Insurance?</td>
                <td colspan="3">
                    <input type="radio" id="insuranceYes" name="insurance" value="Yes" title="Select if you have insurance" onchange="saveToLocalStorage('insurance')" required>
                    <label for="insuranceYes">Yes</label>
                    
                    <input type="radio" id="insuranceNo" name="insurance" value="No" title="Select if you do not have insurance" onchange="saveToLocalStorage('insurance')">
                    <label for="insuranceNo">No</label>
                </td>
            </tr>
            <tr>
                <td class="required">Health Score (1 to 10):</td>
                <td colspan="3">
                    <div style="display: flex; align-items: center; gap: 15px;">
                        <input type="range" 
                               id="healthScore" 
                               name="healthScore" 
                               min="1" 
                               max="10" 
                               value="5"
                               title="Slide to rate your health from 1 (poor) to 10 (excellent)"
                               style="flex: 1; cursor: pointer; accent-color: #6a0dad;"
                               oninput="updateHealthScore()"
                               onchange="saveToLocalStorage('healthScore')"
                               required>
                        <div style="display: flex; align-items: baseline; gap: 5px; min-width: 80px;">
                            <span id="healthScoreValue" style="font-size: 28px; font-weight: bold; color: #6a0dad;">5</span>
                            <span style="font-size: 16px; color: #7b2cbf; font-weight: bold;">/ 10</span>
                        </div>
                    </div>
                </td>
            </tr>
            <tr>
                <td colspan="4" style="padding-top: 20px; padding-bottom: 10px;">
                    <label style="display: flex; align-items: center; gap: 8px;">
                        <input type="checkbox" id="rememberMe" checked onchange="handleRememberMe()" style="width: 18px; height: 18px; cursor: pointer;">
                        <span style="color: #2563eb; font-weight: bold; font-size: 16px;">Remember me for future visits</span>
                    </label>
                    <p style="margin: 5px 0 0 26px; font-style: italic; color: #6b7280; font-size: 14px;">
                        If checked, your information will be saved for convenience (expires in 48 hours for security)
                    </p>
                </td>
            </tr>
        </table>

        <br>
        <center>
            <button type="button" id="reviewBtn" onclick="reviewForm()">REVIEW</button>
            <button type="button" id="submitBtn" onclick="submitForm()">SUBMIT</button>
            <button type="reset" onclick="clearReview(); clearAllData();">START OVER</button>
        </center>
    </form>

    <!-- Review Section (Initially Hidden) -->
    <div id="reviewSection" style="display: none;">
        <h2 style="text-align: center; margin-top: 30px; color: #6a0dad;">PLEASE REVIEW THIS INFORMATION</h2>
        <div id="reviewContent" style="background-color: white; padding: 30px; border-radius: 10px; box-shadow: 0 0 10px rgba(106, 13, 173, 0.2); margin-top: 20px;">
        </div>
    </div>

    <hr style="margin-bottom: 20px;">

    <!-- Fixed Footer -->
    <footer>
        <center>
            <p>Oasis Health Care | <a href="/cdn-cgi/l/email-protection#c8aba7a6bca9abbc88a7a9bba1bba0ada9a4bca0aba9baade6aba7a5" style="color: #6a0dad;">Contact Us</a> | 801 Wells Branch Pkwy, Pflugerville, TX 7